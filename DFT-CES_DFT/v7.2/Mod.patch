diff -urN qe-7.2_ori/Modules/input_parameters.f90 qe-7.2/Modules/input_parameters.f90
--- qe-7.2_ori/Modules/input_parameters.f90	2023-03-27 17:12:09.000000000 +0100
+++ qe-7.2/Modules/input_parameters.f90	2023-10-08 01:01:32.000000000 +0100
@@ -281,6 +281,15 @@
         !! to enhance performance.
         DATA memory_allowed / 'small', 'default', 'large' /
 
+! DFT-CES start
+        LOGICAL :: dft_ces = .false.
+        ! If true reads MD rho from file "file_pot"
+        CHARACTER(len=80) :: rho_ces = './rho_ces.cube'
+        CHARACTER(len=80) :: rho_ces_ion = './rho_ces_ion.cube'
+        CHARACTER(len=80) :: rho_ces_rep = './rho_ces_rep.cube'
+        ! File containing the MD.rho as gaussian cube format
+        ! with conventional charge sign: -1 = electron
+! DFT-CES end
         !
         CHARACTER(len=256) :: input_xml_schema_file = ' '
         !! location of xml input according to xsd schema
@@ -292,6 +301,9 @@
           gdir, nppstr, wf_collect, lelfield, nberrycyc, refg,            &
           tefield2, saverho, tabps, use_wannier, lecrpa,                  &
           lfcp, tqmmm, vdw_table_name, lorbm, memory, point_label_type,   &
+! DFT-CES start
+          dft_ces, rho_ces, rho_ces_ion, rho_ces_rep,                    &
+! DFT-CES end
           input_xml_schema_file, gate, trism, twochem
 !
 !=----------------------------------------------------------------------------=!
diff -urN qe-7.2_ori/Modules/make.depend qe-7.2/Modules/make.depend
--- qe-7.2_ori/Modules/make.depend	1970-01-01 01:00:00.000000000 +0100
+++ qe-7.2/Modules/make.depend	2023-10-08 01:01:32.000000000 +0100
@@ -0,0 +1,966 @@
+#####################################################################
+# Automatically generated file - if you notice lines looking like
+# some_file.o: @some_module@ 
+# figure out why "some_module", referenced in "some_file.o", is not 
+# found: check spelling, presence in one of the DEPEND* directories
+# as defined in file "install/makedeps.sh"; if "some_module" is an 
+# external module, add it to the module lists "sysdeps", "libdeps",
+# "cudadeps" defined in "install/makedeps.sh".
+# Finally, from the top QE directory, run "make depend" to regenerate
+# the files - DO NOT EDIT MANUALLY (unless you know what you are doing)
+####################################################################
+additional_kpoints.o : ../UtilXlib/mp.o
+additional_kpoints.o : cell_base.o
+additional_kpoints.o : input_parameters.o
+additional_kpoints.o : io_global.o
+additional_kpoints.o : kind.o
+additional_kpoints.o : mp_images.o
+additional_kpoints.o : parameters.o
+allocate_fft_3drism.o : ../FFTXlib/src/fft_types.o
+allocate_fft_3drism.o : cell_base.o
+allocate_fft_3drism.o : control_flags.o
+allocate_fft_3drism.o : kind.o
+allocate_fft_3drism.o : mp_rism.o
+allocate_fft_3drism.o : recvec_3drism.o
+atom_weight.o : kind.o
+autopilot.o : ../UtilXlib/mp.o
+autopilot.o : io_global.o
+autopilot.o : kind.o
+autopilot.o : mp_world.o
+autopilot.o : parser.o
+basic_algebra_routines.o : kind.o
+becmod.o : ../UtilXlib/mp.o
+becmod.o : control_flags.o
+becmod.o : kind.o
+becmod.o : mp_bands.o
+becmod.o : noncol.o
+becmod.o : recvec.o
+becmod_gpu.o : becmod.o
+becmod_subs_gpu.o : ../UtilXlib/mp.o
+becmod_subs_gpu.o : becmod.o
+becmod_subs_gpu.o : becmod_gpu.o
+becmod_subs_gpu.o : control_flags.o
+becmod_subs_gpu.o : kind.o
+becmod_subs_gpu.o : mp_bands.o
+becmod_subs_gpu.o : noncol.o
+becmod_subs_gpu.o : recvec.o
+bfgs_module.o : basic_algebra_routines.o
+bfgs_module.o : constants.o
+bfgs_module.o : invmat.o
+bfgs_module.o : io_files.o
+bfgs_module.o : kind.o
+bspline.o : kind.o
+bz_form.o : constants.o
+bz_form.o : io_global.o
+bz_form.o : kind.o
+cell_base.o : constants.o
+cell_base.o : control_flags.o
+cell_base.o : invmat.o
+cell_base.o : io_global.o
+cell_base.o : kind.o
+check_stop.o : ../UtilXlib/clocks_handler.o
+check_stop.o : ../UtilXlib/mp.o
+check_stop.o : io_files.o
+check_stop.o : io_global.o
+check_stop.o : kind.o
+check_stop.o : mp_images.o
+check_stop.o : set_signal.o
+chempot.o : ../UtilXlib/mp.o
+chempot.o : cell_base.o
+chempot.o : constants.o
+chempot.o : err_rism.o
+chempot.o : kind.o
+chempot.o : rism.o
+chempot.o : solvmol.o
+chempot_lauerism.o : ../UtilXlib/mp.o
+chempot_lauerism.o : cell_base.o
+chempot_lauerism.o : constants.o
+chempot_lauerism.o : control_flags.o
+chempot_lauerism.o : err_rism.o
+chempot_lauerism.o : kind.o
+chempot_lauerism.o : rism.o
+chempot_lauerism.o : solvmol.o
+closure.o : constants.o
+closure.o : err_rism.o
+closure.o : kind.o
+closure.o : rism.o
+command_line_options.o : ../UtilXlib/mp.o
+command_line_options.o : io_global.o
+command_line_options.o : mp_world.o
+compute_dipole.o : ../FFTXlib/src/fft_types.o
+compute_dipole.o : ../UtilXlib/mp.o
+compute_dipole.o : cell_base.o
+compute_dipole.o : fft_base.o
+compute_dipole.o : kind.o
+compute_dipole.o : mp_bands.o
+constants.o : kind.o
+constraints_module.o : basic_algebra_routines.o
+constraints_module.o : cell_base.o
+constraints_module.o : constants.o
+constraints_module.o : input_parameters.o
+constraints_module.o : io_global.o
+constraints_module.o : ions_base.o
+constraints_module.o : kind.o
+control_flags.o : kind.o
+control_flags.o : parameters.o
+corrdipole_laue.o : ../FFTXlib/src/fft_types.o
+corrdipole_laue.o : ../UtilXlib/mp.o
+corrdipole_laue.o : cell_base.o
+corrdipole_laue.o : constants.o
+corrdipole_laue.o : err_rism.o
+corrdipole_laue.o : kind.o
+corrdipole_laue.o : rism.o
+corrdipole_laue.o : solvmol.o
+correctat0_vv.o : ../UtilXlib/mp.o
+correctat0_vv.o : constants.o
+correctat0_vv.o : err_rism.o
+correctat0_vv.o : kind.o
+correctat0_vv.o : rism.o
+correctat0_vv.o : solvmol.o
+corrgxy0_laue.o : ../FFTXlib/src/fft_types.o
+corrgxy0_laue.o : ../UtilXlib/mp.o
+corrgxy0_laue.o : err_rism.o
+corrgxy0_laue.o : kind.o
+corrgxy0_laue.o : rism.o
+cryst_to_car.o : kind.o
+cryst_to_car_2d.o : kind.o
+data_structure_3drism.o : ../FFTXlib/src/fft_types.o
+data_structure_3drism.o : cell_base.o
+data_structure_3drism.o : command_line_options.o
+data_structure_3drism.o : fft_base.o
+data_structure_3drism.o : kind.o
+data_structure_3drism.o : mp_bands.o
+data_structure_3drism.o : mp_rism.o
+data_structure_3drism.o : recvec_3drism.o
+deviatoric.o : io_global.o
+deviatoric.o : kind.o
+dist.o : cell_base.o
+dist.o : constants.o
+dist.o : io_global.o
+dist.o : ions_base.o
+dist.o : kind.o
+do_1drism.o : ../UtilXlib/mp.o
+do_1drism.o : check_stop.o
+do_1drism.o : control_flags.o
+do_1drism.o : err_rism.o
+do_1drism.o : io_global.o
+do_1drism.o : kind.o
+do_1drism.o : mdiis.o
+do_1drism.o : radfft.o
+do_1drism.o : rism.o
+do_3drism.o : ../FFTXlib/src/fft_interfaces.o
+do_3drism.o : ../FFTXlib/src/fft_types.o
+do_3drism.o : check_stop.o
+do_3drism.o : control_flags.o
+do_3drism.o : err_rism.o
+do_3drism.o : io_global.o
+do_3drism.o : kind.o
+do_3drism.o : mdiis.o
+do_3drism.o : rism.o
+do_3drism.o : solvmol.o
+do_lauerism.o : ../FFTXlib/src/fft_types.o
+do_lauerism.o : ../UtilXlib/mp.o
+do_lauerism.o : check_stop.o
+do_lauerism.o : control_flags.o
+do_lauerism.o : err_rism.o
+do_lauerism.o : io_global.o
+do_lauerism.o : kind.o
+do_lauerism.o : lauefft.o
+do_lauerism.o : mdiis.o
+do_lauerism.o : rism.o
+do_lauerism.o : solvmol.o
+electrons_base.o : constants.o
+electrons_base.o : io_global.o
+electrons_base.o : kind.o
+environ_base_module.o : ../upflib/uspp_param.o
+environ_base_module.o : control_flags.o
+environ_base_module.o : environ_api_stub.o
+environ_base_module.o : fft_base.o
+environ_base_module.o : io_global.o
+environ_base_module.o : ions_base.o
+environ_base_module.o : kind.o
+environ_base_module.o : mp_bands.o
+environ_base_module.o : mp_images.o
+environment.o : ../UtilXlib/clib_wrappers.o
+environment.o : ../UtilXlib/mp.o
+environment.o : command_line_options.o
+environment.o : control_flags.o
+environment.o : fox_init_module.o
+environment.o : io_files.o
+environment.o : io_global.o
+environment.o : kind.o
+environment.o : mp_bands.o
+environment.o : mp_images.o
+environment.o : mp_pools.o
+environment.o : mp_world.o
+environment.o : qeh5_module.o
+environment.o : version.o
+eqn_1drism.o : constants.o
+eqn_1drism.o : err_rism.o
+eqn_1drism.o : kind.o
+eqn_1drism.o : rism.o
+eqn_1drism.o : solvmol.o
+eqn_3drism.o : ../UtilXlib/mp.o
+eqn_3drism.o : constants.o
+eqn_3drism.o : err_rism.o
+eqn_3drism.o : kind.o
+eqn_3drism.o : rism.o
+eqn_3drism.o : solvmol.o
+eqn_lauedipole.o : ../UtilXlib/mp.o
+eqn_lauedipole.o : cell_base.o
+eqn_lauedipole.o : constants.o
+eqn_lauedipole.o : err_rism.o
+eqn_lauedipole.o : kind.o
+eqn_lauedipole.o : rism.o
+eqn_lauedipole.o : solvmol.o
+eqn_lauegxy0.o : ../UtilXlib/mp.o
+eqn_lauegxy0.o : cell_base.o
+eqn_lauegxy0.o : err_rism.o
+eqn_lauegxy0.o : kind.o
+eqn_lauegxy0.o : rism.o
+eqn_lauegxy0.o : solvmol.o
+eqn_lauelong.o : ../UtilXlib/mp.o
+eqn_lauelong.o : cell_base.o
+eqn_lauelong.o : constants.o
+eqn_lauelong.o : err_rism.o
+eqn_lauelong.o : kind.o
+eqn_lauelong.o : rism.o
+eqn_lauelong.o : solvmol.o
+eqn_lauerism.o : ../UtilXlib/mp.o
+eqn_lauerism.o : cell_base.o
+eqn_lauerism.o : err_rism.o
+eqn_lauerism.o : kind.o
+eqn_lauerism.o : rism.o
+eqn_lauerism.o : solvmol.o
+eqn_laueshort.o : ../UtilXlib/mp.o
+eqn_laueshort.o : cell_base.o
+eqn_laueshort.o : err_rism.o
+eqn_laueshort.o : kind.o
+eqn_laueshort.o : rism.o
+eqn_laueshort.o : solvmol.o
+eqn_lauevoid.o : ../UtilXlib/mp.o
+eqn_lauevoid.o : cell_base.o
+eqn_lauevoid.o : constants.o
+eqn_lauevoid.o : err_rism.o
+eqn_lauevoid.o : kind.o
+eqn_lauevoid.o : rism.o
+eqn_lauevoid.o : solvmol.o
+err_rism.o : ../UtilXlib/mp.o
+expint.o : kind.o
+extffield.o : io_files.o
+extffield.o : io_global.o
+extffield.o : ions_base.o
+extffield.o : kind.o
+extffield.o : parameters.o
+extffield.o : parser.o
+fd_gradient.o : ../FFTXlib/src/fft_types.o
+fd_gradient.o : ../FFTXlib/src/scatter_mod.o
+fd_gradient.o : ../UtilXlib/mp.o
+fd_gradient.o : cell_base.o
+fd_gradient.o : fft_base.o
+fd_gradient.o : kind.o
+fd_gradient.o : mp_bands.o
+fft_base.o : ../FFTXlib/src/fft_smallbox_type.o
+fft_base.o : ../FFTXlib/src/fft_types.o
+fft_base.o : ../FFTXlib/src/stick_base.o
+fft_base.o : ../UtilXlib/parallel_include.o
+fft_rho.o : ../FFTXlib/src/fft_helper_subroutines.o
+fft_rho.o : ../FFTXlib/src/fft_interfaces.o
+fft_rho.o : ../FFTXlib/src/fft_types.o
+fft_rho.o : control_flags.o
+fft_rho.o : kind.o
+fft_wave.o : ../FFTXlib/src/fft_helper_subroutines.o
+fft_wave.o : ../FFTXlib/src/fft_interfaces.o
+fft_wave.o : ../FFTXlib/src/fft_types.o
+fft_wave.o : control_flags.o
+fft_wave.o : kind.o
+fox_init_module.o : ../UtilXlib/mp.o
+fox_init_module.o : io_global.o
+fox_init_module.o : mp_images.o
+funct.o : ../XClib/xc_beef_interface.o
+funct.o : ../XClib/xc_lib.o
+funct.o : io_global.o
+funct.o : kind.o
+funct.o : xc_rVV10.o
+funct.o : xc_vdW_DF.o
+generate_function.o : ../FFTXlib/src/fft_types.o
+generate_function.o : ../UtilXlib/mp.o
+generate_function.o : cell_base.o
+generate_function.o : constants.o
+generate_function.o : fft_base.o
+generate_function.o : io_global.o
+generate_function.o : kind.o
+generate_function.o : mp_bands.o
+generate_k_along_lines.o : kind.o
+gradutils.o : ../FFTXlib/src/fft_helper_subroutines.o
+gradutils.o : ../FFTXlib/src/fft_interfaces.o
+gradutils.o : ../FFTXlib/src/fft_types.o
+gradutils.o : cell_base.o
+gradutils.o : fft_base.o
+gradutils.o : kind.o
+gradutils.o : recvec.o
+guess_3drism.o : ../FFTXlib/src/fft_types.o
+guess_3drism.o : ../UtilXlib/mp.o
+guess_3drism.o : cell_base.o
+guess_3drism.o : constants.o
+guess_3drism.o : err_rism.o
+guess_3drism.o : kind.o
+guess_3drism.o : rism.o
+guess_3drism.o : solvmol.o
+gvecw.o : ../UtilXlib/mp.o
+gvecw.o : kind.o
+gvecw.o : recvec.o
+hdf5_qe.o : ../UtilXlib/mp.o
+hdf5_qe.o : ../UtilXlib/parallel_include.o
+hdf5_qe.o : io_files.o
+hdf5_qe.o : kind.o
+hdf5_qe.o : mp_world.o
+init_1drism.o : err_rism.o
+init_1drism.o : kind.o
+init_1drism.o : rism.o
+init_3drism.o : err_rism.o
+init_3drism.o : kind.o
+init_3drism.o : rism.o
+init_3drism.o : rism1d_facade.o
+init_3drism.o : solute.o
+inpfile.o : open_close_input_file.o
+input_1drism.o : cell_base.o
+input_1drism.o : constants.o
+input_1drism.o : input_parameters.o
+input_1drism.o : io_files.o
+input_1drism.o : kind.o
+input_1drism.o : molecule_const.o
+input_1drism.o : read_solv.o
+input_1drism.o : recvec.o
+input_1drism.o : rism.o
+input_1drism.o : rism1d_facade.o
+input_1drism.o : solvmol.o
+input_3drism.o : cell_base.o
+input_3drism.o : constants.o
+input_3drism.o : input_parameters.o
+input_3drism.o : ions_base.o
+input_3drism.o : kind.o
+input_3drism.o : recvec.o
+input_3drism.o : rism.o
+input_3drism.o : rism3d_facade.o
+input_3drism.o : solute.o
+input_3drism.o : solvmol.o
+input_parameters.o : ../upflib/upf_params.o
+input_parameters.o : kind.o
+input_parameters.o : parameters.o
+input_parameters.o : wannier_new.o
+invmat.o : kind.o
+io_base.o : ../UtilXlib/mp.o
+io_base.o : io_global.o
+io_base.o : kind.o
+io_base.o : mp_wave.o
+io_base.o : qeh5_module.o
+io_base.o : recvec.o
+io_files.o : ../UtilXlib/clib_wrappers.o
+io_files.o : ../UtilXlib/mp.o
+io_files.o : io_global.o
+io_files.o : kind.o
+io_files.o : mp_images.o
+io_files.o : parameters.o
+io_rism_xml.o : err_rism.o
+io_rism_xml.o : io_files.o
+io_rism_xml.o : io_global.o
+io_rism_xml.o : kind.o
+io_rism_xml.o : rism.o
+io_rism_xml.o : xml_io_rism.o
+ions_base.o : ../upflib/uspp_param.o
+ions_base.o : cell_base.o
+ions_base.o : constants.o
+ions_base.o : io_global.o
+ions_base.o : kind.o
+ions_base.o : parameters.o
+ions_base.o : random_numbers.o
+latgen.o : constants.o
+latgen.o : io_global.o
+latgen.o : kind.o
+lauefft.o : ../FFTXlib/src/fft_scalar.o
+lauefft.o : ../FFTXlib/src/fft_scatter.o
+lauefft.o : ../FFTXlib/src/fft_scatter_2d.o
+lauefft.o : ../FFTXlib/src/fft_types.o
+lauefft.o : ../UtilXlib/mp.o
+lauefft.o : ../UtilXlib/parallel_include.o
+lauefft.o : control_flags.o
+lauefft.o : kind.o
+lauefft_subs.o : ../FFTXlib/src/fft_support.o
+lauefft_subs.o : ../UtilXlib/mp.o
+lauefft_subs.o : cell_base.o
+lauefft_subs.o : constants.o
+lauefft_subs.o : control_flags.o
+lauefft_subs.o : kind.o
+lauefft_subs.o : lauefft.o
+linpack.o : kind.o
+lj_forcefield.o : err_rism.o
+lj_forcefield.o : kind.o
+lj_solute.o : ../FFTXlib/src/fft_types.o
+lj_solute.o : ../UtilXlib/mp.o
+lj_solute.o : cell_base.o
+lj_solute.o : constants.o
+lj_solute.o : err_rism.o
+lj_solute.o : ions_base.o
+lj_solute.o : kind.o
+lj_solute.o : rism.o
+lj_solute.o : solute.o
+lj_solute.o : solvmol.o
+mbdlib.o : cell_base.o
+mbdlib.o : constants.o
+mbdlib.o : control_flags.o
+mbdlib.o : funct.o
+mbdlib.o : io_global.o
+mbdlib.o : ions_base.o
+mbdlib.o : kind.o
+mbdlib.o : tsvdw.o
+mdiis.o : ../UtilXlib/mp.o
+mdiis.o : kind.o
+mm_dispersion.o : ../UtilXlib/mp.o
+mm_dispersion.o : cell_base.o
+mm_dispersion.o : constants.o
+mm_dispersion.o : io_global.o
+mm_dispersion.o : ions_base.o
+mm_dispersion.o : kind.o
+mm_dispersion.o : mp_images.o
+mm_dispersion.o : parameters.o
+molebridge_vv.o : constants.o
+molebridge_vv.o : err_rism.o
+molebridge_vv.o : kind.o
+molebridge_vv.o : rism.o
+molebridge_vv.o : solvmol.o
+molecorr_vv.o : constants.o
+molecorr_vv.o : err_rism.o
+molecorr_vv.o : kind.o
+molecorr_vv.o : rism.o
+molecorr_vv.o : solvmol.o
+molecule_const.o : constants.o
+molecule_const.o : kind.o
+molecule_types.o : kind.o
+more_functionals.o : constants.o
+more_functionals.o : kind.o
+mp_bands.o : ../UtilXlib/mp.o
+mp_bands.o : ../UtilXlib/parallel_include.o
+mp_exx.o : ../UtilXlib/mp.o
+mp_exx.o : ../UtilXlib/parallel_include.o
+mp_exx.o : control_flags.o
+mp_exx.o : io_global.o
+mp_exx.o : mp_bands.o
+mp_global.o : ../UtilXlib/mp.o
+mp_global.o : ../UtilXlib/parallel_include.o
+mp_global.o : command_line_options.o
+mp_global.o : mp_bands.o
+mp_global.o : mp_images.o
+mp_global.o : mp_pools.o
+mp_global.o : mp_world.o
+mp_images.o : ../UtilXlib/mp.o
+mp_images.o : ../UtilXlib/parallel_include.o
+mp_images.o : io_global.o
+mp_pools.o : ../UtilXlib/mp.o
+mp_pools.o : ../UtilXlib/parallel_include.o
+mp_rism.o : ../UtilXlib/mp.o
+mp_rism.o : ../UtilXlib/parallel_include.o
+mp_swap_ax_rism.o : ../UtilXlib/mp.o
+mp_swap_ax_rism.o : ../UtilXlib/parallel_include.o
+mp_swap_ax_rism.o : kind.o
+mp_swap_ax_rism.o : mp_rism.o
+mp_wave.o : ../UtilXlib/parallel_include.o
+mp_wave.o : kind.o
+mp_world.o : ../UtilXlib/mp.o
+mp_world.o : ../UtilXlib/parallel_include.o
+mp_world.o : io_global.o
+noncol.o : kind.o
+noncol.o : parameters.o
+normalize_lauerism.o : ../UtilXlib/mp.o
+normalize_lauerism.o : cell_base.o
+normalize_lauerism.o : constants.o
+normalize_lauerism.o : err_rism.o
+normalize_lauerism.o : kind.o
+normalize_lauerism.o : rism.o
+normalize_lauerism.o : solvmol.o
+open_close_input_file.o : io_global.o
+parser.o : ../UtilXlib/mp.o
+parser.o : io_global.o
+parser.o : kind.o
+parser.o : mp_images.o
+plot_io.o : io_global.o
+plot_io.o : kind.o
+plot_rism.o : io_global.o
+plot_rism.o : kind.o
+plugin_arguments.o : ../UtilXlib/mp.o
+plugin_arguments.o : io_global.o
+plugin_arguments.o : kind.o
+plugin_arguments.o : plugin_flags.o
+plugin_flags.o : kind.o
+plugin_flags.o : parameters.o
+plugin_variables.o : kind.o
+plugin_variables.o : parameters.o
+potential_3drism.o : ../FFTXlib/src/fft_interfaces.o
+potential_3drism.o : cell_base.o
+potential_3drism.o : constants.o
+potential_3drism.o : control_flags.o
+potential_3drism.o : err_rism.o
+potential_3drism.o : fft_base.o
+potential_3drism.o : kind.o
+potential_3drism.o : lauefft.o
+potential_3drism.o : rism.o
+potential_3drism.o : solvmol.o
+potential_esm.o : ../UtilXlib/mp.o
+potential_esm.o : cell_base.o
+potential_esm.o : constants.o
+potential_esm.o : err_rism.o
+potential_esm.o : ions_base.o
+potential_esm.o : kind.o
+potential_esm.o : mp_bands.o
+potential_esm.o : recvec.o
+potential_esm.o : rism.o
+potential_vv.o : constants.o
+potential_vv.o : err_rism.o
+potential_vv.o : kind.o
+potential_vv.o : rism.o
+potential_vv.o : solvmol.o
+print_chempot_3drism.o : ../UtilXlib/mp.o
+print_chempot_3drism.o : constants.o
+print_chempot_3drism.o : err_rism.o
+print_chempot_3drism.o : io_global.o
+print_chempot_3drism.o : kind.o
+print_chempot_3drism.o : molecule_const.o
+print_chempot_3drism.o : rism.o
+print_chempot_3drism.o : solvmol.o
+print_chempot_lauerism.o : ../UtilXlib/mp.o
+print_chempot_lauerism.o : constants.o
+print_chempot_lauerism.o : err_rism.o
+print_chempot_lauerism.o : io_global.o
+print_chempot_lauerism.o : kind.o
+print_chempot_lauerism.o : molecule_const.o
+print_chempot_lauerism.o : rism.o
+print_chempot_lauerism.o : solvmol.o
+print_chempot_vv.o : constants.o
+print_chempot_vv.o : err_rism.o
+print_chempot_vv.o : io_global.o
+print_chempot_vv.o : kind.o
+print_chempot_vv.o : molecule_const.o
+print_chempot_vv.o : rism.o
+print_chempot_vv.o : solvmol.o
+print_corr_vv.o : ../UtilXlib/mp.o
+print_corr_vv.o : constants.o
+print_corr_vv.o : err_rism.o
+print_corr_vv.o : io_files.o
+print_corr_vv.o : io_global.o
+print_corr_vv.o : kind.o
+print_corr_vv.o : rism.o
+print_corr_vv.o : solvmol.o
+print_solvavg.o : ../FFTXlib/src/fft_interfaces.o
+print_solvavg.o : ../UtilXlib/mp.o
+print_solvavg.o : constants.o
+print_solvavg.o : control_flags.o
+print_solvavg.o : err_rism.o
+print_solvavg.o : io_files.o
+print_solvavg.o : io_global.o
+print_solvavg.o : kind.o
+print_solvavg.o : lauefft.o
+print_solvavg.o : rism.o
+print_solvavg.o : rism1d_facade.o
+print_solvavg.o : solvavg.o
+print_solvavg.o : solvmol.o
+pw_dot.o : ../UtilXlib/mp.o
+pw_dot.o : kind.o
+pw_dot.o : mp_pools.o
+pw_dot.o : recvec.o
+qeh5_module.o : kind.o
+qes_bcast_module.o : ../UtilXlib/mp.o
+qes_bcast_module.o : io_global.o
+qes_bcast_module.o : qes_types_module.o
+qes_init_module.o : kind.o
+qes_init_module.o : qes_types_module.o
+qes_libs_module.o : qes_bcast_module.o
+qes_libs_module.o : qes_init_module.o
+qes_libs_module.o : qes_read_module.o
+qes_libs_module.o : qes_reset_module.o
+qes_libs_module.o : qes_write_module.o
+qes_read_module.o : ../upflib/dom.o
+qes_read_module.o : qes_types_module.o
+qes_reset_module.o : qes_types_module.o
+qes_types_module.o : kind.o
+qes_write_module.o : ../upflib/wxml.o
+qes_write_module.o : qes_types_module.o
+qexsd.o : ../UtilXlib/clocks_handler.o
+qexsd.o : ../upflib/dom.o
+qexsd.o : ../upflib/wxml.o
+qexsd.o : control_flags.o
+qexsd.o : input_parameters.o
+qexsd.o : kind.o
+qexsd.o : mp_bands.o
+qexsd.o : mp_images.o
+qexsd.o : mp_pools.o
+qexsd.o : mp_world.o
+qexsd.o : qes_init_module.o
+qexsd.o : qes_read_module.o
+qexsd.o : qes_reset_module.o
+qexsd.o : qes_types_module.o
+qexsd.o : qes_write_module.o
+qexsd.o : qexsd_init.o
+qexsd.o : qexsd_input.o
+qexsd.o : version.o
+qexsd_copy.o : io_files.o
+qexsd_copy.o : kind.o
+qexsd_copy.o : molecule_types.o
+qexsd_copy.o : qes_types_module.o
+qexsd_init.o : cell_base.o
+qexsd_init.o : constants.o
+qexsd_init.o : ions_base.o
+qexsd_init.o : kind.o
+qexsd_init.o : mp_bands.o
+qexsd_init.o : mp_images.o
+qexsd_init.o : mp_pools.o
+qexsd_init.o : mp_world.o
+qexsd_init.o : noncol.o
+qexsd_init.o : qes_init_module.o
+qexsd_init.o : qes_reset_module.o
+qexsd_init.o : qes_types_module.o
+qexsd_input.o : kind.o
+qexsd_input.o : qes_init_module.o
+qexsd_input.o : qes_reset_module.o
+qexsd_input.o : qes_types_module.o
+qmmm.o : ../FFTXlib/src/fft_types.o
+qmmm.o : ../UtilXlib/mp.o
+qmmm.o : ../UtilXlib/parallel_include.o
+qmmm.o : cell_base.o
+qmmm.o : constants.o
+qmmm.o : constraints_module.o
+qmmm.o : input_parameters.o
+qmmm.o : io_global.o
+qmmm.o : ions_base.o
+qmmm.o : kind.o
+qmmm.o : mp_pools.o
+qmmm.o : mp_world.o
+radfft.o : ../FFTXlib/src/fft_scalar.o
+radfft.o : ../FFTXlib/src/fft_support.o
+radfft.o : ../UtilXlib/mp.o
+radfft.o : constants.o
+radfft.o : kind.o
+radial_gradients.o : kind.o
+random_numbers.o : kind.o
+random_numbers_gpu.o : kind.o
+random_numbers_gpu.o : random_numbers.o
+read_cards.o : ../UtilXlib/clib_wrappers.o
+read_cards.o : additional_kpoints.o
+read_cards.o : autopilot.o
+read_cards.o : bz_form.o
+read_cards.o : cell_base.o
+read_cards.o : constants.o
+read_cards.o : input_parameters.o
+read_cards.o : io_global.o
+read_cards.o : kind.o
+read_cards.o : parameters.o
+read_cards.o : parser.o
+read_cards.o : wannier_new.o
+read_cards.o : wypos.o
+read_input.o : ../UtilXlib/mp.o
+read_input.o : input_parameters.o
+read_input.o : io_global.o
+read_input.o : kind.o
+read_input.o : mp_images.o
+read_input.o : open_close_input_file.o
+read_input.o : read_cards.o
+read_input.o : read_namelists.o
+read_mol.o : ../upflib/dom.o
+read_mol.o : ../upflib/upf_utils.o
+read_mol.o : constants.o
+read_mol.o : kind.o
+read_mol.o : molecule_const.o
+read_mol.o : molecule_types.o
+read_namelists.o : ../UtilXlib/mp.o
+read_namelists.o : constants.o
+read_namelists.o : input_parameters.o
+read_namelists.o : io_global.o
+read_namelists.o : kind.o
+read_namelists.o : mp_images.o
+read_pseudo.o : ../UtilXlib/clib_wrappers.o
+read_pseudo.o : ../UtilXlib/mp.o
+read_pseudo.o : ../XClib/xc_lib.o
+read_pseudo.o : ../upflib/atom.o
+read_pseudo.o : ../upflib/gth.o
+read_pseudo.o : ../upflib/pseudo_types.o
+read_pseudo.o : ../upflib/radial_grids.o
+read_pseudo.o : ../upflib/read_upf_new.o
+read_pseudo.o : ../upflib/read_upf_v1.o
+read_pseudo.o : ../upflib/read_uspp.o
+read_pseudo.o : ../upflib/upf_auxtools.o
+read_pseudo.o : ../upflib/upf_to_internal.o
+read_pseudo.o : ../upflib/uspp.o
+read_pseudo.o : ../upflib/uspp_param.o
+read_pseudo.o : funct.o
+read_pseudo.o : io_files.o
+read_pseudo.o : io_global.o
+read_pseudo.o : ions_base.o
+read_pseudo.o : kind.o
+read_pseudo.o : mp_images.o
+read_solv.o : ../UtilXlib/mp.o
+read_solv.o : io_files.o
+read_solv.o : io_global.o
+read_solv.o : kind.o
+read_solv.o : mp_images.o
+read_solv.o : read_mol.o
+read_solv.o : solvmol.o
+recips.o : kind.o
+recvec.o : ../UtilXlib/mp.o
+recvec.o : constants.o
+recvec.o : control_flags.o
+recvec.o : kind.o
+recvec_3drism.o : ../FFTXlib/src/fft_types.o
+recvec_3drism.o : ../UtilXlib/mp.o
+recvec_3drism.o : ../UtilXlib/parallel_include.o
+recvec_3drism.o : cell_base.o
+recvec_3drism.o : constants.o
+recvec_3drism.o : control_flags.o
+recvec_3drism.o : kind.o
+recvec_3drism.o : recvec.o
+recvec_3drism.o : recvec_subs.o
+recvec_subs.o : ../FFTXlib/src/fft_ggen.o
+recvec_subs.o : ../FFTXlib/src/fft_types.o
+recvec_subs.o : ../UtilXlib/mp.o
+recvec_subs.o : constants.o
+recvec_subs.o : kind.o
+remove_tot_torque.o : kind.o
+rgen.o : kind.o
+rism.o : ../FFTXlib/src/fft_types.o
+rism.o : kind.o
+rism.o : lauefft.o
+rism.o : mp_rism.o
+rism.o : radfft.o
+rism.o : recvec_3drism.o
+rism1d_facade.o : ../UtilXlib/mp.o
+rism1d_facade.o : err_rism.o
+rism1d_facade.o : io_global.o
+rism1d_facade.o : io_rism_xml.o
+rism1d_facade.o : kind.o
+rism1d_facade.o : mp_images.o
+rism1d_facade.o : rism.o
+rism1d_facade.o : solvmol.o
+rism3d_facade.o : ../UtilXlib/mp.o
+rism3d_facade.o : cell_base.o
+rism3d_facade.o : constants.o
+rism3d_facade.o : control_flags.o
+rism3d_facade.o : err_rism.o
+rism3d_facade.o : io_global.o
+rism3d_facade.o : io_rism_xml.o
+rism3d_facade.o : ions_base.o
+rism3d_facade.o : kind.o
+rism3d_facade.o : mp_bands.o
+rism3d_facade.o : mp_images.o
+rism3d_facade.o : recvec.o
+rism3d_facade.o : rism.o
+rism3d_facade.o : solute.o
+rism3d_facade.o : solvmol.o
+rms_residual.o : ../UtilXlib/mp.o
+rms_residual.o : kind.o
+scale_fft_3drism.o : cell_base.o
+scale_fft_3drism.o : kind.o
+scale_fft_3drism.o : recvec_3drism.o
+scale_fft_lauerism.o : cell_base.o
+scale_fft_lauerism.o : kind.o
+scale_fft_lauerism.o : lauefft.o
+set_para_diag.o : command_line_options.o
+set_para_diag.o : io_global.o
+set_para_diag.o : mp_bands.o
+set_para_diag.o : mp_exx.o
+set_para_diag.o : mp_pools.o
+set_para_diag.o : mp_world.o
+set_signal.o : ../UtilXlib/mp.o
+set_signal.o : io_global.o
+set_signal.o : mp_world.o
+set_vdw_corr.o : io_global.o
+setqf.o : kind.o
+solute.o : ../UtilXlib/mp.o
+solute.o : cell_base.o
+solute.o : constants.o
+solute.o : err_rism.o
+solute.o : io_global.o
+solute.o : ions_base.o
+solute.o : kind.o
+solute.o : molecule_const.o
+solute.o : mp_images.o
+solute.o : rism.o
+solvation_3drism.o : ../FFTXlib/src/fft_interfaces.o
+solvation_3drism.o : ../UtilXlib/mp.o
+solvation_3drism.o : cell_base.o
+solvation_3drism.o : constants.o
+solvation_3drism.o : err_rism.o
+solvation_3drism.o : io_global.o
+solvation_3drism.o : kind.o
+solvation_3drism.o : rism.o
+solvation_3drism.o : solvmol.o
+solvation_esm.o : ../UtilXlib/mp.o
+solvation_esm.o : cell_base.o
+solvation_esm.o : constants.o
+solvation_esm.o : control_flags.o
+solvation_esm.o : err_rism.o
+solvation_esm.o : ions_base.o
+solvation_esm.o : kind.o
+solvation_esm.o : lauefft.o
+solvation_esm.o : recvec.o
+solvation_esm.o : rism.o
+solvation_esm.o : rism3d_facade.o
+solvation_force.o : ../UtilXlib/mp.o
+solvation_force.o : cell_base.o
+solvation_force.o : constants.o
+solvation_force.o : control_flags.o
+solvation_force.o : err_rism.o
+solvation_force.o : ions_base.o
+solvation_force.o : kind.o
+solvation_force.o : recvec.o
+solvation_force.o : rism.o
+solvation_force.o : solute.o
+solvation_lauerism.o : ../UtilXlib/mp.o
+solvation_lauerism.o : cell_base.o
+solvation_lauerism.o : constants.o
+solvation_lauerism.o : err_rism.o
+solvation_lauerism.o : io_global.o
+solvation_lauerism.o : kind.o
+solvation_lauerism.o : lauefft.o
+solvation_lauerism.o : rism.o
+solvation_lauerism.o : solvmol.o
+solvation_pbc.o : err_rism.o
+solvation_pbc.o : kind.o
+solvation_pbc.o : lauefft.o
+solvation_pbc.o : rism.o
+solvation_stress.o : cell_base.o
+solvation_stress.o : control_flags.o
+solvation_stress.o : err_rism.o
+solvation_stress.o : kind.o
+solvation_stress.o : rism.o
+solvation_stress.o : solute.o
+solvavg.o : ../FFTXlib/src/fft_types.o
+solvavg.o : ../UtilXlib/mp.o
+solvavg.o : ../UtilXlib/parallel_include.o
+solvavg.o : cell_base.o
+solvavg.o : constants.o
+solvavg.o : io_global.o
+solvavg.o : kind.o
+solvavg.o : lauefft.o
+solvmol.o : kind.o
+solvmol.o : molecule_types.o
+sort.o : kind.o
+space_group.o : kind.o
+summary_1drism.o : ../UtilXlib/mp.o
+summary_1drism.o : cell_base.o
+summary_1drism.o : constants.o
+summary_1drism.o : control_flags.o
+summary_1drism.o : io_files.o
+summary_1drism.o : io_global.o
+summary_1drism.o : kind.o
+summary_1drism.o : molecule_const.o
+summary_1drism.o : rism.o
+summary_1drism.o : rism1d_facade.o
+summary_1drism.o : solvmol.o
+summary_3drism.o : cell_base.o
+summary_3drism.o : constants.o
+summary_3drism.o : control_flags.o
+summary_3drism.o : io_global.o
+summary_3drism.o : ions_base.o
+summary_3drism.o : kind.o
+summary_3drism.o : molecule_const.o
+summary_3drism.o : rism.o
+summary_3drism.o : rism3d_facade.o
+summary_3drism.o : solute.o
+summary_3drism.o : solvmol.o
+suscept_g0.o : constants.o
+suscept_g0.o : kind.o
+suscept_laue.o : ../UtilXlib/mp.o
+suscept_laue.o : ../upflib/splinelib.o
+suscept_laue.o : cell_base.o
+suscept_laue.o : constants.o
+suscept_laue.o : err_rism.o
+suscept_laue.o : io_files.o
+suscept_laue.o : io_global.o
+suscept_laue.o : kind.o
+suscept_laue.o : rism.o
+suscept_laue.o : solvavg.o
+suscept_laue.o : solvmol.o
+suscept_laueint.o : ../UtilXlib/mp.o
+suscept_laueint.o : cell_base.o
+suscept_laueint.o : err_rism.o
+suscept_laueint.o : kind.o
+suscept_laueint.o : rism.o
+suscept_laueint.o : solvmol.o
+suscept_vv.o : ../UtilXlib/mp.o
+suscept_vv.o : ../upflib/splinelib.o
+suscept_vv.o : cell_base.o
+suscept_vv.o : err_rism.o
+suscept_vv.o : kind.o
+suscept_vv.o : rism.o
+suscept_vv.o : solvmol.o
+timestep.o : kind.o
+tsvdw.o : ../UtilXlib/mp.o
+tsvdw.o : ../UtilXlib/parallel_include.o
+tsvdw.o : ../XClib/xc_lib.o
+tsvdw.o : ../upflib/uspp_param.o
+tsvdw.o : cell_base.o
+tsvdw.o : constants.o
+tsvdw.o : fft_base.o
+tsvdw.o : io_global.o
+tsvdw.o : ions_base.o
+tsvdw.o : kind.o
+tsvdw.o : mp_bands.o
+tsvdw.o : mp_images.o
+volume.o : kind.o
+w0gauss.o : constants.o
+w0gauss.o : kind.o
+w1gauss.o : constants.o
+w1gauss.o : kind.o
+wannier_gw.o : cell_base.o
+wannier_gw.o : io_global.o
+wannier_gw.o : kind.o
+wannier_gw.o : recvec.o
+wannier_new.o : kind.o
+wave_gauge.o : ../UtilXlib/mp.o
+wave_gauge.o : kind.o
+wave_gauge.o : mp_pools.o
+wavefunctions.o : kind.o
+wavefunctions_gpu.o : wavefunctions.o
+wgauss.o : constants.o
+wgauss.o : kind.o
+write_rism_type.o : io_global.o
+write_rism_type.o : kind.o
+write_rism_type.o : rism.o
+ws_base.o : invmat.o
+ws_base.o : kind.o
+wyckoff.o : kind.o
+wyckoff.o : space_group.o
+wypos.o : kind.o
+xc_rVV10.o : ../FFTXlib/src/fft_interfaces.o
+xc_rVV10.o : ../UtilXlib/mp.o
+xc_rVV10.o : cell_base.o
+xc_rVV10.o : constants.o
+xc_rVV10.o : control_flags.o
+xc_rVV10.o : fft_base.o
+xc_rVV10.o : io_global.o
+xc_rVV10.o : kind.o
+xc_rVV10.o : mp_bands.o
+xc_rVV10.o : recvec.o
+xc_vdW_DF.o : ../FFTXlib/src/fft_interfaces.o
+xc_vdW_DF.o : ../UtilXlib/mp.o
+xc_vdW_DF.o : ../XClib/xc_lib.o
+xc_vdW_DF.o : cell_base.o
+xc_vdW_DF.o : constants.o
+xc_vdW_DF.o : control_flags.o
+xc_vdW_DF.o : fft_base.o
+xc_vdW_DF.o : io_global.o
+xc_vdW_DF.o : kind.o
+xc_vdW_DF.o : mp_bands.o
+xc_vdW_DF.o : mp_images.o
+xc_vdW_DF.o : recvec.o
+xml_io_rism.o : ../FFTXlib/src/fft_types.o
+xml_io_rism.o : ../UtilXlib/mp.o
+xml_io_rism.o : ../UtilXlib/parallel_include.o
+xml_io_rism.o : ../upflib/dom.o
+xml_io_rism.o : ../upflib/wxml.o
+xml_io_rism.o : constants.o
+xml_io_rism.o : io_files.o
+xml_io_rism.o : kind.o
+xml_io_rism.o : lauefft.o
+xsf.o : constants.o
+xsf.o : kind.o
+environment.o : ../include/configure.h
+version.o : ../include/qe_version.h
diff -urN qe-7.2_ori/Modules/read_namelists.f90 qe-7.2/Modules/read_namelists.f90
--- qe-7.2_ori/Modules/read_namelists.f90	2023-03-27 17:12:09.000000000 +0100
+++ qe-7.2/Modules/read_namelists.f90	2023-10-08 01:01:32.000000000 +0100
@@ -135,6 +135,12 @@
        saverho = .TRUE.
        memory = 'default'
        !
+! DFT-CES start
+       dft_ces = .FALSE.
+       rho_ces = './rho_ces.cube'
+       rho_ces_ion = './rho_ces_ion.cube'
+       rho_ces_rep = './rho_ces_rep.cube'
+! DFT-CES end
        CALL get_environment_variable( 'QEXML', input_xml_schema_file )
        !
        RETURN
@@ -910,6 +916,12 @@
        CALL mp_bcast( gate,          ionode_id, intra_image_comm ) !TB
        CALL mp_bcast( twochem,       ionode_id, intra_image_comm )
        CALL mp_bcast( mbd_vdw,        ionode_id, intra_image_comm ) !GSz
+! DFT-CES start
+       CALL mp_bcast( dft_ces,       ionode_id, intra_image_comm )
+       CALL mp_bcast( rho_ces,       ionode_id, intra_image_comm )
+       CALL mp_bcast( rho_ces_ion,   ionode_id, intra_image_comm )
+       CALL mp_bcast( rho_ces_rep,   ionode_id, intra_image_comm )
+! DFT-CES end
        !
        RETURN
        !
